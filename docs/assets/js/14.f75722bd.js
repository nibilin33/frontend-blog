(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{400:function(t,s,a){"use strict";a.r(s);var e=a(54),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[a("a",{attrs:{href:"https://juejin.cn/post/7039850183244382216",target:"_blank",rel:"noopener noreferrer"}},[t._v("Chromium源码解读"),a("OutboundLink")],1),t._v(" "),a("a",{attrs:{href:"https://blog.appsignal.com/2020/07/01/a-deep-dive-into-v8.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("深入理解v8"),a("OutboundLink")],1)]),t._v(" "),a("h1",{attrs:{id:"chromium-for-mac"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#chromium-for-mac"}},[t._v("#")]),t._v(" "),a("a",{attrs:{href:"https://github.com/chromium/chromium/blob/main/docs/mac_build_instructions.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("Chromium for Mac"),a("OutboundLink")],1)]),t._v(" "),a("ol",[a("li",[t._v("获取代码\nAppStore Install Xcode"),a("br"),t._v("\nRun sudo xcode-select -s /Applications/Xcode.app/Contents/Developer\n检查是否有sdk\nls "),a("code",[t._v("xcode-select -p")]),t._v(" /Platforms/MacOSX.platform/Developer/SDKs"),a("br"),t._v("\n通过chromium提供的depot_tools获取代码"),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" config --global core.precomposeUnicode "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://chromium.googlesource.com/chromium/tools/depot_tools   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 国外源")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://source.codeaurora.org/quic/lc/chromium/tools/depot_tools    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 国内源")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 在bash_profile插入下面代码 ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("PATH")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/path to depot_tools/depot_tools:'),a("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("$PATH")]),t._v('"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-name function"}},[t._v("proxy_off")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("unset")]),t._v(" http_proxy\n     "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("unset")]),t._v(" https_proxy\n     "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("unset")]),t._v(" ftp_proxy\n     "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("unset")]),t._v(" rsync_proxy\n     "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" -e "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"已关闭代理"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-name function"}},[t._v("proxy_on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("no_proxy")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"localhost,127.0.0.1,localaddress,.localdomain.com"')]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("http_proxy")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://127.0.0.1:1087"')]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("https_proxy")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$http_proxy")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("ftp_proxy")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$http_proxy")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("rsync_proxy")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$http_proxy")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("HTTP_PROXY")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$http_proxy")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("HTTPS_PROXY")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$http_proxy")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("FTP_PROXY")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$http_proxy")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("RSYNC_PROXY")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$http_proxy")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" -e "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"已开启代理"')]),t._v("\n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 保存")]),t._v("\n "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("source")]),t._v(" ~/.bash_profile\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 注意，根据自己的配置设置有可能会是1080或1086")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 需要使用代理时开启ss全局模式，然后打开终端，输入proxy_on就会启动。如果需要关闭，只需要输入proxy_off。")]),t._v("\n proxy_on\n "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" chromium "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" chromium   \n "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 大约需要半小时到一小时")]),t._v("\n fetch chromium \n "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" src\n")])])])]),t._v(" "),a("li",[t._v("准备构建环境"),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# check CPU")]),t._v("\n "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("uname")]),t._v(" -m\n "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# modify cpu args")]),t._v("\n gn args out/Default\n "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# insert args")]),t._v("\n target_os "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mac"')]),t._v("\n target_cpu "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"x64/arm64"')]),t._v("\n is_debug "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n is_component_build "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n")])])])]),t._v(" "),a("li",[t._v("构建Chromium")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("   autoninja -C out/Default chrome\n")])])]),a("ol",{attrs:{start:"4"}},[a("li",[t._v("启动"),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("out/Default/Chromium.app/Contents/MacOS/Chromium --disable-features"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"DialMediaRouteProvider"')]),t._v("\n")])])])]),t._v(" "),a("li",[t._v("Debugging Chromium on macOS\nhttps://github.com/chromium/chromium/blob/main/docs/mac/debugging.md")])]),t._v(" "),a("h1",{attrs:{id:"depot-tools-介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#depot-tools-介绍"}},[t._v("#")]),t._v(" depot_tools 介绍")]),t._v(" "),a("p",[t._v("chromium 开发工具，要求python2.7或者3.8")]),t._v(" "),a("h2",{attrs:{id:"tools"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tools"}},[t._v("#")]),t._v(" Tools")]),t._v(" "),a("p",[t._v("重要的工具")]),t._v(" "),a("h3",{attrs:{id:"fetch"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#fetch"}},[t._v("#")]),t._v(" fetch")]),t._v(" "),a("p",[t._v("用于获取项目，更多信息查看 fetch --help\nfetch configs")]),t._v(" "),a("ul",[a("li",[t._v("android")]),t._v(" "),a("li",[t._v("android_internal")]),t._v(" "),a("li",[t._v("breakpad")]),t._v(" "),a("li",[t._v("chromium")]),t._v(" "),a("li",[t._v("config_util")]),t._v(" "),a("li",[t._v("crashpad")]),t._v(" "),a("li",[t._v("dart")]),t._v(" "),a("li",[t._v("depot_tools")]),t._v(" "),a("li",[t._v("devtools-frontend")]),t._v(" "),a("li",[t._v("flutter")]),t._v(" "),a("li",[t._v("goma_client")]),t._v(" "),a("li",[t._v("gyp")]),t._v(" "),a("li",[t._v("infra")]),t._v(" "),a("li",[t._v("infra_internal")]),t._v(" "),a("li",[t._v("inspector_protocol")]),t._v(" "),a("li",[t._v("ios")]),t._v(" "),a("li",[t._v("ios_internal")]),t._v(" "),a("li",[t._v("nacl")]),t._v(" "),a("li",[t._v("naclports")]),t._v(" "),a("li",[t._v("node-ci")]),t._v(" "),a("li",[t._v("pdfium")]),t._v(" "),a("li",[t._v("skia")]),t._v(" "),a("li",[t._v("skia_buildbot")]),t._v(" "),a("li",[t._v("syzygy")]),t._v(" "),a("li",[t._v("v8")]),t._v(" "),a("li",[t._v("webrtc")]),t._v(" "),a("li",[t._v("webrtc_android")]),t._v(" "),a("li",[t._v("webrtc_ios")]),t._v(" "),a("li",[t._v("website")])]),t._v(" "),a("h3",{attrs:{id:"gclient"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gclient"}},[t._v("#")]),t._v(" gclient")]),t._v(" "),a("p",[t._v("gclient是谷歌开发的一套跨平台git仓库管理工具，用来将多个git仓库组成一个solution进行管理\n它的作用类似 git 的 submodule，用来将多个git仓库组成一个solution进行管理，比如chromium项目是由80多个独立的git仓库构成的.\n更多细节可以看README.gclient.md")]),t._v(" "),a("h3",{attrs:{id:"git-cl"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#git-cl"}},[t._v("#")]),t._v(" git cl")]),t._v(" "),a("p",[t._v("git cl: A code review tool to interact with Rietveld or Gerrit. Use git cl help for more details and README.git-cl.md.")]),t._v(" "),a("h3",{attrs:{id:"roll-dep"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#roll-dep"}},[t._v("#")]),t._v(" roll-dep")]),t._v(" "),a("p",[t._v("roll-dep: A gclient dependency management tool to submit a dep roll, updating a dependency to a newer revision."),a("br"),t._v("\nThere are a lot of git utilities included.")]),t._v(" "),a("h2",{attrs:{id:"updating"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#updating"}},[t._v("#")]),t._v(" Updating")]),t._v(" "),a("p",[t._v("depot_tools updates itself automatically when running gclient tool. To disable auto update, set the environment variable DEPOT_TOOLS_UPDATE=0."),a("br"),t._v("\nTo update package manually, run update_depot_tools.bat on Windows, or ./update_depot_tools on Linux or Mac."),a("br"),t._v("\nOn Windows only, running gclient will install git and python.")]),t._v(" "),a("h2",{attrs:{id:"可能遇到的问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#可能遇到的问题"}},[t._v("#")]),t._v(" 可能遇到的问题")]),t._v(" "),a("ul",[a("li",[t._v('Failed to connect to chromium.googlesource.com port 443: Operation timed out\ngit config --global http.proxy "localhost:1087"')]),t._v(" "),a("li",[t._v("xcode-select: error: tool 'xcodebuild' requires Xcode, but active developer directory '/Library/Developer/CommandLineTools' is a command line tools instance")]),t._v(" "),a("li",[t._v("FileNotFoundError: [Errno 2] No such file or directory: '../../third_party/node/mac/node-darwin-x64/bin/node'\n修改 third_party/node.py\n里面的cpu类型判断有问题")])]),t._v(" "),a("h2",{attrs:{id:"其他参考"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#其他参考"}},[t._v("#")]),t._v(" 其他参考")]),t._v(" "),a("ul",[a("li",[t._v("https://segmentfault.com/a/1190000023231568")]),t._v(" "),a("li",[t._v("https://ijackey.com/mac-%E4%B8%8B-chromium-%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91-716.html")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/chromium/chromium/blob/main/docs/ccache_mac.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("CCache on Mac"),a("OutboundLink")],1),t._v("\nbrew install --HEAD ccache"),a("br"),t._v("\nTo install symlinks for compilers that will automatically use"),a("br"),t._v("\nccache, prepend this directory to your PATH:"),a("br"),t._v("\n/opt/homebrew/opt/ccache/libexec"),a("br"),t._v("\nIf this is an upgrade and you have previously added the symlinks to"),a("br"),t._v("\nyour PATH, you may need to modify it to the path specified above so\nit points to the current version.")])])])}),[],!1,null,null,null);s.default=n.exports}}]);